function AppyType(appy_type,family,icon,Appy_container){this.appy_type=appy_type;this.family=family;this,icon=icon;this.container_id=Appy_container;this.objects=Array()}function HomeView(Memory){this.template;this.hoteldata=[];this.el=$("<div/>");this.Memory=Memory;this.rootFilePath="aa";this.typeArray=Array();this.initialize=function(){this.template=Handlebars.compile($("#front_page_list").html());this.setContext()};this.render=function(){var context={Hotel:this.hoteldata};var html=this.template(context);this.el.html(html);return this};this.setContext=function(){var self=this;this.rootFilePath=app.localFilePath+"/"+app.app_dir;self.hoteldata.length=0;self.Memory.db.allDocs({include_docs:true}).then(function(result){var types_array=new Object;result.rows.forEach(function(row){if(row.doc.appy_family!=null&&row.doc.doc_type=="Assets"){var single_type=new Array;single_type["appy_type"]=row.doc.appy_type;single_type["icon"]=row.doc.appy_icon;single_type["appy_family"]=row.doc.appy_family;types_array[single_type["appy_family"]]=single_type}});$("#my_appies").empty();for(var type in types_array){var doc_type=types_array[type]["appy_type"];var icon=types_array[type]["icon"];var family=types_array[type]["appy_family"];$div=$("<div>",{id:"appy_family"+doc_type,"class":"my_appy_type","data-typeappies":doc_type+"_type_cnt"});$div.html('<div class="no_load text-body">'+family+"</div>");self.typeArray[doc_type]=new AppyType(doc_type,family,icon,doc_type+"_type_cnt");$("#my_appies").append($div);var hoteldata=[];$div_cnt=$("<div>",{id:doc_type+"_type_cnt","class":"appy_type_list"});$("#appies_list").append($div_cnt);self.Memory.db.query("doc_type",{key:doc_type,include_docs:true,attachments:true}).then(function(result){var root_family="";result.rows.forEach(function(row){row.doc.hotel_logo=self.rootFilePath+"/dir"+row.doc._id+"/"+removeUrl(row.doc.hotel_logo);var short_desc=row.doc.hotel_description;var endofstr="...";var readmore=1;if(short_desc.length<=MAX_SHORT_DESC){endofstr="";readmore=0}short_desc=short_desc.substring(0,MAX_SHORT_DESC)+""+endofstr;var obj={hotel_title:row.doc.hotel_title,hotel_description:short_desc,hotel_logo:row.doc.hotel_logo,id:row.doc._id,vip_pass:row.doc.vip_pass};root_family=row.doc.doc_type;hoteldata.push(obj)});if(hoteldata.length>0){var context={Hotel:hoteldata}}else{context={}}hoteldata=[];var html=self.template(context);$(".display_after_load").load(function(){$(this).siblings(".no_load").addClass("img_loaded");$(this).addClass("img_loaded")});$("#"+root_family+"_type_cnt").html(html);var off=$(window).height()-80}).catch(function(err){})}}).catch(function(){})};this.initialize()}